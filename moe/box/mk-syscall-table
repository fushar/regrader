#!/bin/sh
set -e
echo '/* Syscall table automatically generated by mk-syscall-table */'
echo
cat <<FOE |
#include "autoconf.h"
#if defined(CONFIG_BOX_KERNEL_AMD64) && !defined(CONFIG_BOX_USER_AMD64)
#include <asm/unistd_32.h>
#else
#include <asm/unistd.h>
#endif
FOE
	gcc -E -dM "$@" - |
	sed '/__NR_madvise1/d; s/^#define __NR_\([^ 	]\+\)[ 	]\+\([0-9]\+\).*/\/* \2 *\/ [ __NR_\1 ] = "\1",/;t;d' |
	sort -k2 -n
